import"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js";document.addEventListener("DOMContentLoaded",()=>{const r=JSON.parse(document.getElementById("places-data").textContent),a=JSON.parse(document.getElementById("target-url").textContent),s=JSON.parse(document.getElementById("zoom-level").textContent),e=r.find(t=>t.url==a),c=e?[e.lat,e.lng]:[35.97607932324101,140.1408927819724],n=L.map("map").setView(c,s);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(n);const d=L.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),p=L.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});r.forEach(t=>{const i=t.url===a,l=L.marker([t.lat,t.lng],{icon:i?p:d}).addTo(n);if(i){const g=L.Control.extend({options:{position:"topright"},onAdd:function(){const o=L.DomUtil.create("div","leaflet-bar leaflet-control");return o.style.backgroundColor="white",o.style.padding="5px",o.style.cursor="pointer",o.title="Google Mapで開く",o.innerHTML="🔗Google Mapで開く",o.style.color="black",o.onclick=function(){`${t.lat}`,`${t.lng}`;const m=`${t.gmap}`;window.open(m,"_blank")},o}});n.addControl(new g),l.bindPopup(`${t.title}`)}else l.bindPopup(`<a href="${t.url}">${t.title}</a>`)})});
