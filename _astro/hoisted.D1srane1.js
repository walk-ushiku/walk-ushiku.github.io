import"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js";document.addEventListener("DOMContentLoaded",()=>{const r=JSON.parse(document.getElementById("places-data").textContent),a=JSON.parse(document.getElementById("target-url").textContent),s=JSON.parse(document.getElementById("center").textContent),c=JSON.parse(document.getElementById("zoom-level").textContent),o=r.find(t=>t.url==a),d=o?[o.lat,o.lng]:s,n=L.map("map").setView(d,c);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(n);const p=L.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),m=L.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});r.forEach(t=>{const i=t.url===a,l=L.marker([t.lat,t.lng],{icon:i?m:p}).addTo(n);if(i){const g=L.Control.extend({options:{position:"topright"},onAdd:function(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control");return e.style.backgroundColor="white",e.style.padding="5px",e.style.cursor="pointer",e.title="Google Mapで開く",e.innerHTML="🔗Google Mapで開く",e.style.color="black",e.onclick=function(){`${t.lat}`,`${t.lng}`;const u=`${t.gmap}`;window.open(u,"_blank")},e}});n.addControl(new g),l.bindPopup(`${t.title}`)}else l.bindPopup(`<a href="${t.url}">${t.title}</a>`)})});
